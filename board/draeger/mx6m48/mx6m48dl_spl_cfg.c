/*
 * mx6m48dl_spl_cfg.c
 *
 *  Created on: 18.01.2018
 *      Author: baehrino
 */

#define CONFIG_MX6DL
#include <common.h>
#include <asm/arch/mx6-ddr.h>
#include <asm/arch/mx6dl-ddr.h>
#include "mx6m48_spl_cfg.h"

m48_configuration ddr_setup_mx6dl [] =
{
 {MX6_IOM_DRAM_SDQS0, 0x00000018},
 {MX6_IOM_DRAM_SDQS1, 0x00000018},
 {MX6_IOM_DRAM_SDQS2, 0x00000018},
 {MX6_IOM_DRAM_SDQS3, 0x00000018},
 {MX6_IOM_DRAM_SDQS4, 0x00000018},
 {MX6_IOM_DRAM_SDQS5, 0x00000018},
 {MX6_IOM_DRAM_SDQS6, 0x00000018},
 {MX6_IOM_DRAM_SDQS7, 0x00000018},

 {MX6_IOM_GRP_B0DS, 0x00000030},
 {MX6_IOM_GRP_B1DS, 0x00000030},
 {MX6_IOM_GRP_B2DS, 0x00000030},
 {MX6_IOM_GRP_B3DS, 0x00000030},
 {MX6_IOM_GRP_B4DS, 0x00000030},
 {MX6_IOM_GRP_B5DS, 0x00000030},
 {MX6_IOM_GRP_B6DS, 0x00000030},
 {MX6_IOM_GRP_B7DS, 0x00000030},
 {MX6_IOM_GRP_ADDDS, 0x00000030},
 /* 40 Ohm drive strength for cs0/1,sdba2,cke0/1,sdwe */
 {MX6_IOM_GRP_CTLDS, 0x00000030},

 {MX6_IOM_DRAM_DQM0, 0x00000030},
 {MX6_IOM_DRAM_DQM1, 0x00000030},
 {MX6_IOM_DRAM_DQM2, 0x00000030},
 {MX6_IOM_DRAM_DQM3, 0x00000030},
 {MX6_IOM_DRAM_DQM4, 0x00000030},
 {MX6_IOM_DRAM_DQM5, 0x00000030},
 {MX6_IOM_DRAM_DQM6, 0x00000030},
 {MX6_IOM_DRAM_DQM7, 0x00000030},

 {MX6_IOM_DRAM_CAS, 0x00000030},
 {MX6_IOM_DRAM_RAS, 0x00000030},
 {MX6_IOM_DRAM_SDCLK_0, 0x00020030},
 {MX6_IOM_DRAM_SDCLK_1, 0x00020030},

 {MX6_IOM_DRAM_RESET, 0x00000030},

 {MX6_IOM_DRAM_SDODT0, 0x00003030},
 {MX6_IOM_DRAM_SDODT1, 0x00003030},

 /* (differential input) */
 {MX6_IOM_DDRMODE_CTL, 0x00020000},
 /* (no differential input) */
 {MX6_IOM_GRP_DDRMODE, 0x00000000},
 /* disable ddr pullups */
 {MX6_IOM_GRP_DDRPKE, 0x00000000},

 {MX6_IOM_GRP_DDR_TYPE, 0x000C0000},
};
int ddr_setup_mx6dl_size = ARRAY_SIZE(ddr_setup_mx6dl);


m48_configuration ram_setup_mx6dl [] =
{
 /* Read data DQ Byte0-8 delay (added by NXP) */
 {MX6_MMDC_P0_MPRDDQBY0DL, 0x33333333},
 {MX6_MMDC_P0_MPRDDQBY1DL, 0x33333333},
 {MX6_MMDC_P0_MPRDDQBY2DL, 0x33333333},
 {MX6_MMDC_P0_MPRDDQBY3DL, 0x33333333},
 {MX6_MMDC_P1_MPRDDQBY0DL, 0x33333333},
 {MX6_MMDC_P1_MPRDDQBY1DL, 0x33333333},
 {MX6_MMDC_P1_MPRDDQBY2DL, 0x33333333},
 {MX6_MMDC_P1_MPRDDQBY3DL, 0x33333333},

 /* A recent recommendation was added for i.mx6DQ Rev C or later Devices
 This has been seen to improve measured duty cycle by setting fine tune SDCLK duty cyc to low.
 If you are not experiencing issues, you could leave this commented out. (added by NXP)
 {0x021b08c0, 0x24921492},
 {0x021b48c0, 0x24921492},
 */

 {MX6_MMDC_P0_MPMUR0, 0x00000800},
 {MX6_MMDC_P1_MPMUR0, 0x00000800},

 {MX6_MMDC_P0_MDPDC, 0x0002002D},
 {MX6_MMDC_P0_MDOTC, 0x00333030},
 {MX6_MMDC_P0_MDCFG0, 0x434052F3},
 {MX6_MMDC_P0_MDCFG1, 0xB66E8D63},
 {MX6_MMDC_P0_MDCFG2, 0x01FF00DB},
 /* Moved here from "ddr-setup.cfg" (recommended by NXP) */
 {MX6_MMDC_P0_MDMISC, 0x00021740},

 {MX6_MMDC_P0_MDSCR, 0x00008000},
 {MX6_MMDC_P0_MDRWD, 0x000026D2},
 {MX6_MMDC_P0_MDOR, 0x00431023},
 {MX6_MMDC_P0_MDASP, 0x00000047},
 {MX6_MMDC_P0_MDCTL, 0x841A0000},

 {MX6_MMDC_P0_MDSCR, 0x04008032},
 {MX6_MMDC_P0_MDSCR, 0x00008033},
 {MX6_MMDC_P0_MDSCR, 0x00048031},
 {MX6_MMDC_P0_MDSCR, 0x13208030},
 {MX6_MMDC_P0_MDSCR, 0x04008040},

 {MX6_MMDC_P0_MDREF, 0x00007800},
 {MX6_MMDC_P0_MPODTCTRL, 0x00033337},
 {MX6_MMDC_P1_MPODTCTRL, 0x00033337},

 {MX6_MMDC_P0_MDPDC, 0x0002556D},
 {MX6_MMDC_P0_MAPSR, 0x00011006},

 {MX6_MMDC_P0_MDSCR, 0x00000000},

};
int ram_setup_mx6dl_size = ARRAY_SIZE(ram_setup_mx6dl);

m48_configuration ram_calibration_mx6dl_06 [] =
{
 {MX6_MMDC_P0_MPZQHWCTRL, 0xA1390003},
 /* {MX6_MMDC_P1_MPZQHWCTRL, 0xA1390003},   Only for LPDDR2 */
 {MX6_MMDC_P0_MPWLDECTRL0, 0x001F001F},
 {MX6_MMDC_P0_MPWLDECTRL1, 0x001F001F},
 {MX6_MMDC_P1_MPWLDECTRL0, 0x001F001F},
 {MX6_MMDC_P1_MPWLDECTRL1, 0x001F001F},
 {MX6_MMDC_P0_MPDGCTRL0, 0x42580258},
 {MX6_MMDC_P0_MPDGCTRL1, 0x0244024C},
 {MX6_MMDC_P1_MPDGCTRL0, 0x424C0250},
 {MX6_MMDC_P1_MPDGCTRL1, 0x02300244},
 {MX6_MMDC_P0_MPRDDLCTL, 0x444A484A},
 {MX6_MMDC_P1_MPRDDLCTL, 0x44484C40},
 {MX6_MMDC_P0_MPWRDLCTL, 0x12123434},
 {MX6_MMDC_P1_MPWRDLCTL, 0x3C34142E},
};
int ram_calibration_mx6dl_size_06 = ARRAY_SIZE(ram_calibration_mx6dl_06);

m48_configuration ram_calibration_mx6dl_08 [] =
{
 {MX6_MMDC_P0_MPZQHWCTRL, 0xA1390003},
 /* {MX6_MMDC_P1_MPZQHWCTRL, 0xA1390003},   Only for LPDDR2 */
 {MX6_MMDC_P0_MPWLDECTRL0, 0x0078006c},
 {MX6_MMDC_P0_MPWLDECTRL1, 0x00980090},
 {MX6_MMDC_P1_MPWLDECTRL0, 0x00e400d8},
 {MX6_MMDC_P1_MPWLDECTRL1, 0x00c700c7},
 {MX6_MMDC_P0_MPDGCTRL0, 0x42580258},
 {MX6_MMDC_P0_MPDGCTRL1, 0x0244024C},
 {MX6_MMDC_P1_MPDGCTRL0, 0x424C0250},
 {MX6_MMDC_P1_MPDGCTRL1, 0x02300244},
 {MX6_MMDC_P0_MPRDDLCTL, 0x444A484A},
 {MX6_MMDC_P1_MPRDDLCTL, 0x44484C40},
 {MX6_MMDC_P0_MPWRDLCTL, 0x12123434},
 {MX6_MMDC_P1_MPWRDLCTL, 0x3C34142E},
};
int ram_calibration_mx6dl_size_08 = ARRAY_SIZE(ram_calibration_mx6dl_08);
